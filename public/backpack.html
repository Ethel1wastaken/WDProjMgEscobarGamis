<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Conway's Playground">
    <meta name="keywords" content="Conway's Game of Life">
    <meta name="author" content="Joanna Escobar, Elijah Gamis">
    
    <title> My Backpack </title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../dropdown.css">
    <link rel="stylesheet" href="font-awesome-4.7.0/font-awesome-4.7.0/css/font-awesome.min.css">

    <script src="../dropdown.js" defer></script>

</head>
<body>
    <header>
        <nav>
            <div class="navbar">
                <div id="siteLogo">
                    <a href="../home.html"> <img src="../assets/logoFinal.png" alt="Logo" title="Conway's Playground Logo" width="90vw" height="90vh"></a>
                    <h2 class="inline-header"> Conway's Playground </h2>
                </div>
                    
                <div class="dropdown">
                    <button class="dropbtn"> Create <i class="fa fa-angle-down"></i> </button>
                    <div class="dropdown-content">
                        <a href="./index.html"> Maker </a>
                        <a href="./backpack.html"> Backpack </a>
                    </div>
                </div>

                <div id="accountsButton">
                    <a href="./signup.html"><button> <i class="fa fa-user fa-5x"></i></button></a>
                </div> 
            </div>
        </nav>
    </header>

    <section class="title">
        <h1> My Backpack </h1>
    </section>

    <section>
        <button class="collapsible" id="recents"> Recents </button>
        <div class="content" id="recentsContent" style="background-color: light-dark(#d7faa2, #45795b);">
            <p>No recent patterns.</p>
        </div>
    </section>
    
    <section>
        <button class="collapsible" id="myCreations"> My Creations </button>
        <div class="content" id="myCreationsContent" style="background-color: light-dark(#f4adc9, #934165);">
            <p>No patterns created yet.</p>
        </div>
    </section>

    <section>
        <button class="collapsible" id="otherCreators"> Other Creators </button>
        <div class="content" id="otherCreatorsContent" style="background-color: light-dark(#c4fcf9, #59548e);">
            <p>No shared patterns available.</p>
        </div>
    </section>

    <script>
        // Collapsible toggling
        const coll = document.getElementsByClassName("collapsible")
        for (let i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
                this.classList.toggle("open")
                let content = this.nextElementSibling
                if (content.style.display === "block") 
                    content.style.display = "none"
                else 
                    content.style.display = "block"
            })
        }

        // Load patterns from backpack localStorage
        const loadBackpack = () => {
            const backpack = JSON.parse(localStorage.getItem('backpack') || '{"myCreations": [], "recents": [], "otherCreators": []}')
            
            const renderPatternList = (patterns, containerId) => {
                const container = document.getElementById(containerId)
                if (!patterns || patterns.length === 0) {
                    container.innerHTML = '<p>No patterns in this section.</p>'
                    return
                }
                const list = document.createElement('ul')
                list.style.listStyle = 'none'
                list.style.padding = '8px 12px'
                patterns.forEach((p, idx) => {
                    const li = document.createElement('li')
                    li.style.padding = '6px 0'
                    li.style.cursor = 'pointer'
                    li.style.borderBottom = '1px solid rgba(0,0,0,0.1)'
                    li.innerText = p.title || `Pattern ${idx + 1}`
                    li.onclick = () => {
                        localStorage.setItem('selectedPattern', JSON.stringify(p))
                        window.location.href = './index.html'
                    }
                    li.onmouseover = () => li.style.background = 'rgba(0,0,0,0.1)'
                    li.onmouseout = () => li.style.background = 'none'
                    list.appendChild(li)
                })
                container.innerHTML = ''
                container.appendChild(list)
            }

            renderPatternList(backpack.recents, 'recentsContent')
            renderPatternList(backpack.myCreations, 'myCreationsContent')
            renderPatternList(backpack.otherCreators, 'otherCreatorsContent')
        }

        loadBackpack()
    </script>

</body>
</html>